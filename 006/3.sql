INSERT INTO DEPARTMENT (DEPT_CODE,START_DATE,END_DATE,DEPT_NAME,LAYER,UP_DEPT_CODE,VALID_FLG,UPDATE_USER_NAME,USER_UPDATE_DATETIME)
SELECT 'B300','2023-04-01',NULL,'新設部門',LAYER,UP_DEPT_CODE,'1',UPDATE_USER_NAME,'2023-04-01 00:00:00'
FROM DEPARTMENT
WHERE DEPT_CODE = 'A100';

UPDATE DEPARTMENT
SET END_DATE = '2023-03-31',
    VALID_FLG = '0',
    UPDATE_USER_NAME = 'ORG_CHG',
    USER_UPDATE_DATETIME = '2023-03-31 23:59:59'
WHERE
    DEPT_CODE in ('A100','A200');

UPDATE EMP
SET DEPT_CODE = 'B300',
    START_DATE = '2023-04-01',
    UPDATE_USER_NAME = 'ORG_CHG',
    USER_UPDATE_DATETIME = '2023-04-01 00:00:00'
WHERE
    DEPT_CODE in ('A100','A200') and
    VALID_FLG = '1';

select * from DEPARTMENT where DEPT_CODE in ('A100','A200','B300');
-- select * from EMP where DEPT_CODE = 'B300';
